<!DOCTYPE html>

<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Emergency MAP</title>
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&coordorder=longlat" type="text/javascript"></script>
  <script src="map.js" type="text/javascript"></script>

  <style>
    body, html {
      padding: 0;
      margin: 0;
      width: 100%;
      height: 100%;
    }
    #map {
      width: 100%;
      height: 90%;
    }
  </style>
</head>

<body>
<div id="map"></div>


<script>
    var kek;
    ymaps.ready(function () {
        makeRequest(); // Когда карта прогрузится, делаем первый запрос
    });
    function makeRequest() {
        var arr = { City: 'Moscow', Age: 25 };
        $.ajax({
            url: "/api/regionsList",
            type: 'POST',
            data: 'startDate=2016-01-01&endDate=2017-01-01',
            async: false,
            success: function(msg) {
                cities = JSON.parse(msg);
                for(let i = 0; i < cities.length; i++) {
                    ShowCity(cities[i]['name'], cities[i]['color'], cities[i]['color'])
                }
                kek = msg;
            },
            error: function(msg) {
                kek = msg;
                alert(msg);
            }
        });
    }


</script>
</body>

</html>

